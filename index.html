<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>sunkissed com ‚Äî checkout</title>
  <script src="https://js.stripe.com/v3/"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=AcXVrBMJRow03VVLxTl2d0OPDapv4PtizxelcC1gGmejPyihTcNBm6gAzfPaZ51c5JuSAzoGotXzrANE&currency=EUR&disable-funding=card"></script>
  <style>
body {
  margin: 0;
  font-family: "Inter", sans-serif;
  background: #f1f5f9;
  display: flex;
  justify-content: center;
  min-height: 100vh;
  color: #334155;
}
.container {
  display: flex;
  max-width: 800px;
  width: 95%;
  background: #fff;
  margin: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.08);
  overflow: hidden;
  flex-wrap: wrap;
}
.checkout {
  flex: 1;
  padding: 24px;
}
.sidebar {
  width: 320px;
  background: #f9fafb;
  padding: 24px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  border-left: 1px solid #e2e8f0;
}
.logo {
  max-width: 120px;
  margin-bottom: 16px;
}
.product-name {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 8px;
}
.product-desc {
  font-size: 13px;
  margin-bottom: 16px;
}
.promo-section {
  margin-top: 16px;
  font-size: 14px;
}
.promo-section input {
  width: 100%;
  padding: 8px;
  font-size: 14px;
  border: 1px solid #cbd5e1;
  border-radius: 6px;
  margin-top: 6px;
  margin-bottom: 6px;
  background: #f9fafb;
}
.promo-section button {
  padding: 8px 12px;
  background: #c2d6f6;
  color: #ffffff;
  border: 1px solid #c2d6f6;
  font-size: 13px;
  border-radius: 6px;
  cursor: pointer;
  margin-right: 4px;
  transition: all 0.2s ease;
}
.promo-section button:hover {
  transform: translateY(-2px);
  background: #eef2ff;
}
.promo-message {
  margin-top: 6px;
  font-size: 13px;
}
.tip-section {
  margin-top: 16px;
  padding: 12px;
  background: #ffffff;
  border-radius: 8px;
  border: 1px solid #c2d6f6;
  box-shadow: 0 2px 8px rgba(67,56,202,0.1);
  transition: transform 0.2s ease;
}
.tip-section:hover {
  transform: translateY(-2px);
}
.tip-section label {
  font-weight: 700;
  font-size: 14px;
  margin-bottom: 8px;
  display: block;
}
.tip-buttons {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}
.tip-buttons button {
  padding: 8px 12px;
  background: #c2d6f6;
  color: #ffffff;
  border: 1px solid #c2d6f6;
  border-radius: 6px;
  cursor: pointer;
  font-size: 13px;
  transition: all 0.2s ease;
}
.tip-buttons button:hover {
  background: #eef2ff;
  transform: translateY(-2px);
}
.tip-buttons button.active {
  background: #b2cbf2;
  color: #fff;
  border-color: #b2cbf2;
}
.total-price {
  margin-top: 12px;
  font-size: 15px;
  font-weight: 600;
}
h1 {
  text-align: center;
  margin-bottom: 16px;
}
label {
  display: block;
  font-weight: 600;
  margin: 16px 0 6px;
  font-size: 13px;
}
input:not(.promo-input) {
  width: 100%;
  padding: 10px;
  font-size: 14px;
  border: 1px solid #cbd5e1;
  border-radius: 6px;
  background: #f9fafb;
}
input:focus {
  outline: none;
  border-color: #4338ca;
  background: #fff;
}
#paypal-button-container {
  width: 100%;
}
/* Force PayPal button iframe to full width */
#paypal-button-container > div > iframe {
  width: 100% !important;
  min-width: 100% !important;
}
#stripe-payment-request-button {
  width: 100%;
}
#card-element {
  border: 1px solid #cbd5e1;
  padding: 10px;
  border-radius: 6px;
  background: #f9fafb;
  margin-top: 6px;
  margin-bottom: 16px;
}
#payment-message {
  margin-top: 12px;
  text-align: center;
  font-size: 14px;
  display: none;
}
#payment-message.success {
  color: #16a34a;
  display: block;
}
#payment-message.error {
  color: #dc2626;
  display: block;
}
.pay-button {
  width: 100%;
  background: #c2d6f6;
  color: #ffffff;
  border: 1px solid #c2d6f6;
  padding: 12px;
  font-size: 15px;
  font-weight: 600;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
}
.pay-button:hover {
  transform: translateY(-2px);
  background: #eef2ff;
}
input[type="text"],
input[type="email"],
input[type="number"] {
  height: 38px;
  padding: 6px 10px;
  font-size: 14px;
  box-sizing: border-box;
}
  </style>
</head>
<body>
  <div class="container">
    <div class="checkout">
      <h1>‚óü‚Äø ·•¥“ª·•±·•¥k·•Ü·•ôùóç</h1>

      <div id="payment-buttons" style="display: flex; gap: 12px; margin-bottom: 16px;">
        <div id="paypal-button-container"></div>
        <div id="stripe-payment-request-button"></div>
      </div>

      <label for="email">·•±‚Äîm·•≤—ñ·•£</label>
      <input type="email" id="email" placeholder="·•°·•Ü·•ô@·•±·•ä·•≤m‚ç¥·•£·•±.·•¥·•Üm" />

      <label for="name">ùñø·•ô·•£·•£ ·•£·•±g·•≤·•£ ·•í·•≤m·•±</label>
      <input type="text" id="name" placeholder="·•°·•Ü·•ôr ùñø·•ô·•£·•£ ·•í·•≤m·•±" />

      <label for="amount">·•≤m·•Ü·•ô·•íùóç</label>
      <input type="number" id="amount" placeholder="·•±.g. 20" min="1" step="0.01" />

      <label for="card-element">·•¥·•≤r·É´ ·É´·•±ùóç·•≤—ñ·•£s</label>
      <div id="card-element"></div>

      <form id="payment-form">
        <button type="submit" class="pay-button">·•¥·•Üm‚ç¥·•£·•±ùóç·•± ·•Ür·É´·•±r</button>
        <div id="payment-message"></div>
      </form>
    </div>

    <div class="sidebar">
      <img src="https://i.imgur.com/OYvWQPX.png" alt="Logo" class="logo" />
      <div class="product-name">/s·•ô·•ík—ñss·•±·É´ ·•¥·•Üms</div>
      <div class="product-desc">·•Ür·É´·•±r ùñør·•Üm m—ñ·•£ùóç·•Ü! ‚ç¥·•≤·•°—ñ·•íg ·•ï—ñùóç“ª ·•±·•ôr·•Ü? ‚ç¥·•≤·•° “ª·•±r·•±!</div>

      <div class="promo-section">
        <label for="promo">‚ç¥r·•Üm·•Ü ·•¥·•Ü·É´·•±</label>
        <input type="text" id="promo" placeholder="Enter promo code" />
        <button id="apply-promo">·•≤‚ç¥‚ç¥·•£·•°</button>
        <button id="remove-promo" style="display:none;">r·•±m·•Ü·•é·•±</button>
        <div class="promo-message" id="promo-message"></div>
      </div>

      <div class="tip-section">
        <label>ùóç—ñ‚ç¥ m·•± ·•¥:</label>
        <div class="tip-buttons">
          <button class="tip-btn" data-amount="0">·•í·•Ü ùóç—ñ‚ç¥</button>
          <button class="tip-btn" data-amount="2">+2 ‚Ç¨</button>
          <button class="tip-btn" data-amount="5">+5 ‚Ç¨</button>
          <button class="tip-btn" data-amount="10">+10 ‚Ç¨</button>
        </div>
      </div>

      <div class="total-price">ùóç·•Üùóç·•≤·•£ ·•Üùñø ·•Ür·É´·•±r: <span id="total-amount">0 ‚Ç¨</span></div>
    </div>
  </div>

  <script>
    const stripe = Stripe("pk_live_51RdZW2AuHLqKAXDNm5WqoLwAHcN5EnNCdSVaa4dnlV50mO0KCzsBGryv7djhbufEYbnO1kTKOz6dYGvEOJdSTv0M00WC9gEKO5");
    const elements = stripe.elements();
    const cardElement = elements.create("card");
    cardElement.mount("#card-element");

    const amountInput = document.getElementById("amount");
    const promoInput = document.getElementById("promo");
    const promoMessage = document.getElementById("promo-message");
    const applyPromoBtn = document.getElementById("apply-promo");
    const removePromoBtn = document.getElementById("remove-promo");
    const tipButtons = document.querySelectorAll(".tip-btn");
    const totalAmountEl = document.getElementById("total-amount");

    let promoDiscount = 0;
    let tipAmount = 0;
    let baseAmount = 0;

    function updateTotal() {
      baseAmount = parseFloat(amountInput.value) || 0;
      let discounted = baseAmount - promoDiscount;
      if (discounted < 0) discounted = 0;
      const total = discounted + tipAmount;
      totalAmountEl.textContent = total.toFixed(2) + " ‚Ç¨";
    }

    amountInput.addEventListener("input", updateTotal);

    applyPromoBtn.addEventListener("click", () => {
      const code = promoInput.value.trim().toUpperCase();
      if (code === "SAVE10") {
        promoDiscount = 10;
        promoMessage.textContent = "Promo code applied: 10 ‚Ç¨ off";
        applyPromoBtn.style.display = "none";
        removePromoBtn.style.display = "inline-block";
      } else {
        promoMessage.textContent = "Invalid promo code";
      }
      updateTotal();
    });

    removePromoBtn.addEventListener("click", () => {
      promoDiscount = 0;
      promoInput.value = "";
      promoMessage.textContent = "";
      applyPromoBtn.style.display = "inline-block";
      removePromoBtn.style.display = "none";
      updateTotal();
    });

    tipButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        tipButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        tipAmount = parseFloat(btn.getAttribute("data-amount")) || 0;
        updateTotal();
      });
    });

    // Stripe Payment Request API button setup
    const paymentRequest = stripe.paymentRequest({
      country: 'GR',
      currency: 'eur',
      total: {
        label: 'Total',
        amount: 0, // will update dynamically
      },
      requestPayerName: true,
      requestPayerEmail: true,
    });

    paymentRequest.on('paymentmethod', (ev) => {
      // Immediately complete payment with success without confirming payment intent
      ev.complete('success');
      document.getElementById("payment-message").textContent = "Payment successful!";
      document.getElementById("payment-message").className = "success";
    });

    paymentRequest.on('cancel', () => {
      document.getElementById("payment-message").textContent = "Payment cancelled.";
      document.getElementById("payment-message").className = "error";
    });

    const prButton = elements.create('paymentRequestButton', {
      paymentRequest,
    });

    paymentRequest.canMakePayment().then(function(result) {
      if (result) {
        prButton.mount('#stripe-payment-request-button');
      } else {
        document.getElementById('stripe-payment-request-button').style.display = 'none';
      }
    });

    // Update Payment Request total dynamically based on input
    function updatePaymentRequestTotal() {
      const base = parseFloat(amountInput.value) || 0;
      let discounted = base - promoDiscount;
      if (discounted < 0) discounted = 0;
      const total = discounted + tipAmount;
      paymentRequest.update({
        total: {
          label: 'Total',
          amount: Math.round(total * 100), // amount in cents
        }
      });
    }
    amountInput.addEventListener("input", updatePaymentRequestTotal);
    promoInput.addEventListener("input", updatePaymentRequestTotal);
    tipButtons.forEach(btn => btn.addEventListener("click", updatePaymentRequestTotal));

    updatePaymentRequestTotal();

    // PayPal Buttons
    paypal.Buttons({
      style: {
        layout: 'vertical',
        color: 'gold',
        shape: 'rect',
        label: 'paypal',
        height: 40,
        tagline: false
      },
      createOrder: function(data, actions) {
        const base = parseFloat(amountInput.value) || 0;
        let discounted = base - promoDiscount;
        if (discounted < 0) discounted = 0;
        const total = discounted + tipAmount;

        if (total <= 0) {
          alert("Please enter a valid amount greater than 0.");
          return;
        }

        return actions.order.create({
          purchase_units: [{
            amount: {
              value: total.toFixed(2),
              currency_code: "EUR"
            }
          }]
        });
      },
      onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {
          alert("Transaction completed by " + details.payer.name.given_name + "!");
          document.getElementById("payment-message").textContent = "PayPal payment successful!";
          document.getElementById("payment-message").className = "success";
        });
      },
      onError: function(err) {
        document.getElementById("payment-message").textContent = "PayPal error: " + err;
        document.getElementById("payment-message").className = "error";
      }
    }).render('#paypal-button-container');

    // Stripe card payment form submission (fallback)
    const form = document.getElementById("payment-form");
    const paymentMessage = document.getElementById("payment-message");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      paymentMessage.textContent = "";
      paymentMessage.className = "";

      const base = parseFloat(amountInput.value) || 0;
      let discounted = base - promoDiscount;
      if (discounted < 0) discounted = 0;
      const total = discounted + tipAmount;

      if (total <= 0) {
        paymentMessage.textContent = "Please enter a valid amount greater than 0.";
        paymentMessage.className = "error";
        return;
      }

      // Normally here you would call your backend to create a PaymentIntent and get clientSecret
      // For demo, we'll just simulate success

      paymentMessage.textContent = "Payment completed successfully!";
      paymentMessage.className = "success";
    });
  </script>
</body>
</html>
